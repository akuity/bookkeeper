---
title: Go module
description: Using Bookkeeper's Go module
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# Using Bookkeeper's Go module

Bookkeeper's functionality is available as a [Go](https://go.dev/) module.

To add the module to your project:

```shell
go get github.com/akuityio/bookkeeper
```

## Selecting an interface

The Bookkeeper module allows you to choose from a local or remote interface.

<Tabs groupId="interface">
<TabItem value="local" label="Local">

This allows you to use Bookkeeper's functionality _directly_, but requires that
compatible binaries for Git, Kustomize, ytt, and Helm are present.

In the following example, we obtain a reference to an implementation of the
`bookkeeper.Service` interface with debug-level logging enabled:

```golang
import "github.com/akuityio/bookkeeper"

// ...

svc := bookkeeper.NewService(
  &bookkeeper.ServiceOptions{
    LogLevel: bookkeeper.LogLevelDebug,
  },
)
```

If options are omitted from the call to `bookkeeper.NewService()` (e.g. `nil`
is passed), the default log level is `bookkeeper.LogLevelError`.

:::tip
If you're using the local interface, consider using Bookkeeper's official
Docker image as a base image for your own software. This will ensure the
availability of compatible Git, Kustomize, ytt, and Helm binaries!
:::

</TabItem>
<TabItem value="remote" label="Remote">

This allows you to offload configuration rendering to a Bookkeeper server.

In the following example, we obtain a reference to an implementation of the
`bookkeeper.Client` interface that will trust insecure connections:

```golang
import "github.com/akuityio/bookkeeper"

// ...

client := bookkeeper.NewClient(
  "https://localhost:8443", // Bookkeeper server address
  &bookkeeper.ClientOptions{
    AllowInsecureConnections: true,
  },
)
```

If options are omitted from the call to `bookkeeper.NewClient()` (e.g. `nil`
is passed), insecure connections (e.g. due to certificate errors) are not
trusted by default.

</TabItem>
</Tabs>

## Rendering configuration

Both the local interface (`bookkeeper.Service`) and remote interface
(`bookkeeper.Client`) expose a `RenderConfig()` function with the same
signature. Either can be used as follows:

```golang
res, err := svc.RenderConfig(
  context.Background(),
  bookkeeper.RenderRequest{
    RepoURL: "https://<repo URL>",
    RepoCreds: bookkeeper.RepoCredentials{
      Username: "<username>",
      Password: "<password or personal access token>",
    },
    Commit:       "<sha>",                         // Optional
    TargetBranch: "env/dev",                       // For example
    Images:       []string{"my-new-image:v0.1.0"}, // Optional
  },
)
if err != nil {
  // Handle err
}
```

Unless an error occurs, the response (`bookkeeper.RenderResponse`) from the call
above will contain details of any commit or pull request created by Bookkeeper.
